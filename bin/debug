#!/bin/bash

sudo rm -r /cores/*

({
    ulimit -c unlimited
    bin/run "$1"
} 2>&1) | echo -e "$(cat)"

ls /cores/

for file in /cores/*; do
    if [ -f "$file" ]; then
        echo "Core dump found: $file"
        echo "Running gdb..."
        lldb ./res-out -c "$file"
    fi
done